# Phase 1: ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¿½åŠ  - ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ

**é–‹å§‹æ—¥**: 2025-10-29  
**ãƒ–ãƒ©ãƒ³ãƒ**: `fix/pr31-review-phase1-error-logging`  
**æ‰€è¦æ™‚é–“ï¼ˆäºˆå®šï¼‰**: 15-20åˆ†  
**å„ªå…ˆåº¦**: ğŸ”´ High

---

## ğŸ“‹ å®Ÿè£…ã‚¿ã‚¹ã‚¯

### Task 1: EditPageForm.tsx - Logger Import è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/(protected)/pages/[id]/_components/EditPageForm.tsx`

- [ ] ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­éƒ¨åˆ†ã‚’ç¢ºèª
- [ ] `import logger from "@/lib/logger";` ã‚’è¿½åŠ 
- [ ] ä»–ã®importæ–‡ã¨ä½ç½®ã‚’æƒãˆã‚‹

**ç¢ºèªã‚³ãƒãƒ³ãƒ‰**:
```bash
# Import ãŒæ­£ã—ãè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
grep "import logger" app/\(protected\)/pages/\[id\]/_components/EditPageForm.tsx
```

---

### Task 2: EditPageForm.tsx - ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šã‚¨ãƒ©ãƒ¼ãƒ­ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/(protected)/pages/[id]/_components/EditPageForm.tsx`  
**å¯¾è±¡è¡Œ**: 111-113

#### ä¿®æ­£å‰
```typescript
} catch {
    // ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
}
```

#### ä¿®æ­£å¾Œ
```typescript
} catch (error) {
    logger.error({ error, pageId: page.id }, "ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ");
}
```

- [ ] catch ãƒ–ãƒ­ãƒƒã‚¯ã« `error` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ 
- [ ] logger.error ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è¿½åŠ 
- [ ] pageId ã‚’å«ã‚ã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°æƒ…å ±ï¼‰
- [ ] ã‚³ãƒ¡ãƒ³ãƒˆã‚’å‰Šé™¤ï¼ˆãƒ­ã‚°ã§ä»£æ›¿ï¼‰

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- error ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ catch ã§ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚Œã¦ã„ã‚‹
- logger.error ã®ç¬¬1å¼•æ•°ã«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ç¬¬2å¼•æ•°ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- pageId ãŒå«ã¾ã‚Œã¦ã„ã‚‹

---

### Task 3: EditPageForm.tsx - ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/(protected)/pages/[id]/_components/EditPageForm.tsx`  
**å¯¾è±¡è¡Œ**: 186-190

#### ä¿®æ­£å‰
```typescript
} catch {
    toast.dismiss();
    toast.error("ãƒšãƒ¼ã‚¸ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ");
    throw new Error("ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚¨ãƒ©ãƒ¼");
}
```

#### ä¿®æ­£å¾Œ
```typescript
} catch (error) {
    logger.error({ error, pageId: page.id, title }, "ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚¨ãƒ©ãƒ¼");
    toast.dismiss();
    toast.error("ãƒšãƒ¼ã‚¸ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ");
    throw new Error("ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚¨ãƒ©ãƒ¼", { cause: error });
}
```

- [ ] catch ãƒ–ãƒ­ãƒƒã‚¯ã« `error` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿½åŠ 
- [ ] logger.error ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è¿½åŠ 
- [ ] pageId ã¨ title ã‚’å«ã‚ã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°æƒ…å ±ï¼‰
- [ ] `{ cause: error }` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ï¼ˆå…ƒã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿æŒï¼‰

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- error ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ catch ã§ã‚­ãƒ£ãƒ—ãƒãƒ£ã•ã‚Œã¦ã„ã‚‹
- logger.error ãŒ toast.dismiss() ã®å‰ã«ã‚ã‚‹
- Error ã®ç¬¬2å¼•æ•°ã« `{ cause: error }` ãŒã‚ã‚‹
- ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ãŒä¿æŒã•ã‚Œã‚‹

---

### Task 4: page-links-grid.tsx - Logger Import è¿½åŠ 

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/(protected)/pages/[id]/_components/page-links-grid.tsx`

- [ ] ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­éƒ¨åˆ†ã‚’ç¢ºèª
- [ ] `import logger from "@/lib/logger";` ã‚’è¿½åŠ 
- [ ] ä»–ã®importæ–‡ã¨ä½ç½®ã‚’æƒãˆã‚‹

**ç¢ºèªã‚³ãƒãƒ³ãƒ‰**:
```bash
# Import ãŒæ­£ã—ãè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
grep "import logger" app/\(protected\)/pages/\[id\]/_components/page-links-grid.tsx
```

---

### Task 5: page-links-grid.tsx - ãƒšãƒ¼ã‚¸ä½œæˆå¤±æ•—ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/(protected)/pages/[id]/_components/page-links-grid.tsx`  
**å¯¾è±¡è¡Œ**: 41-44

#### ä¿®æ­£å‰
```typescript
if (insertError || !insertedPage) {
    toast.error("ãƒšãƒ¼ã‚¸ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ");
    return;
}
```

#### ä¿®æ­£å¾Œ
```typescript
if (insertError || !insertedPage) {
    logger.error({ error: insertError, name, noteSlug }, "ãƒšãƒ¼ã‚¸ä½œæˆå¤±æ•—");
    toast.error("ãƒšãƒ¼ã‚¸ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ");
    return;
}
```

- [ ] logger.error ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’è¿½åŠ 
- [ ] insertError, name, noteSlug ã‚’å«ã‚ã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°æƒ…å ±ï¼‰
- [ ] logger.error ã‚’ toast.error ã®å‰ã«é…ç½®

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**:
- logger.error ã®ç¬¬1å¼•æ•°ã« error ã¨ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæƒ…å ±
- nameï¼ˆãƒšãƒ¼ã‚¸åï¼‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- noteSlug ãŒå«ã¾ã‚Œã¦ã„ã‚‹ï¼ˆã©ã®ãƒãƒ¼ãƒˆã¸ã®ä½œæˆã‹ï¼‰

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆãƒ»ç¢ºèªã‚¿ã‚¹ã‚¯

### 1. Lint ãƒã‚§ãƒƒã‚¯

- [ ] `bun lint` ã‚’å®Ÿè¡Œ
- [ ] ã‚¨ãƒ©ãƒ¼ãŒ0ä»¶ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] Warning ãŒã‚ã‚Œã°å¯¾å¿œ

```bash
bun lint
```

### 2. TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯

- [ ] TypeScript ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèª

```bash
bun run type-check
```

### 3. æ—¢å­˜ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

- [ ] `bun test` ã‚’å®Ÿè¡Œ
- [ ] æ—¢å­˜ãƒ†ã‚¹ãƒˆãŒå…¨ã¦ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
- [ ] å¤±æ•—ãŒã‚ã‚Œã°åŸå› ã‚’èª¿æŸ»

```bash
bun test
```

### 4. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®å‹•ä½œç¢ºèª

#### 4-1. ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šã®ã‚¨ãƒ©ãƒ¼ç¢ºèª

- [ ] é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹• (`bun dev`)
- [ ] ãƒšãƒ¼ã‚¸ç·¨é›†ç”»é¢ã‚’é–‹ã
- [ ] ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### 4-2. ãƒšãƒ¼ã‚¸å‰Šé™¤ã®ã‚¨ãƒ©ãƒ¼ç¢ºèª

- [ ] ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’ä½œæˆ
- [ ] ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚’å®Ÿè¡Œï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ã‚’æ„å›³çš„ã«ç™ºç”Ÿã•ã›ã¦ç¢ºèªï¼ˆç•°å¸¸ç³»ï¼‰
- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### 4-3. ãƒšãƒ¼ã‚¸ä½œæˆã®ã‚¨ãƒ©ãƒ¼ç¢ºèª

- [ ] ãƒªãƒ³ã‚¯ã‹ã‚‰ãƒšãƒ¼ã‚¸ä½œæˆã‚’å®Ÿè¡Œï¼ˆæ­£å¸¸ç³»ï¼‰
- [ ] æ¨©é™ã‚¨ãƒ©ãƒ¼ãªã©ã‚’æ„å›³çš„ã«ç™ºç”Ÿã•ã›ã¦ç¢ºèªï¼ˆç•°å¸¸ç³»ï¼‰
- [ ] ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

---

## ğŸ“Š å®Œäº†åŸºæº–

### å¿…é ˆæ¡ä»¶
- [x] å…¨ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¦ã„ã‚‹
- [x] `bun lint` ãŒã‚¨ãƒ©ãƒ¼ãªã—
- [x] `bun test` ãŒå…¨ã¦ãƒ‘ã‚¹
- [x] ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å‹•ä½œç¢ºèªæ¸ˆã¿
- [x] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ãŒé©åˆ‡ã«å‡ºåŠ›ã•ã‚Œã‚‹

### æ¨å¥¨æ¡ä»¶
- [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å•é¡Œãªã—
- [ ] ãƒ­ã‚°ãŒæ§‹é€ åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼ˆJSONå½¢å¼ï¼‰
- [ ] ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ãŒé©åˆ‡ï¼ˆerror ã‚’ä½¿ç”¨ï¼‰

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1 å®Œäº†å¾Œ
1. [ ] å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
2. [ ] ãƒ–ãƒ©ãƒ³ãƒã‚’ãƒ—ãƒƒã‚·ãƒ¥
3. [ ] PR#31 (develop â†’ main) ã«è¿½åŠ ã‚³ãƒŸãƒƒãƒˆ
   - ã¾ãŸã¯ã€develop ãƒ–ãƒ©ãƒ³ãƒã«ç›´æ¥ãƒãƒ¼ã‚¸
4. [ ] Phase 2 ã®æº–å‚™

### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¾‹
```bash
git add app/(protected)/pages/[id]/_components/EditPageForm.tsx
git add app/(protected)/pages/[id]/_components/page-links-grid.tsx
git commit -m "fix: Add error logging for better debugging

- Add logger import to EditPageForm.tsx and page-links-grid.tsx
- Add error logging for thumbnail auto-set failures
- Add error logging for page deletion with error cause preservation
- Add error logging for page creation failures
- Include context information (pageId, title, name, noteSlug) in logs

Fixes Gemini Code Assist review comments in PR#31"
```

---

## ğŸ“ ä½œæ¥­ãƒ­ã‚°

### 2025-10-29

#### é–‹å§‹æ™‚åˆ»: __:__

- [ ] Task 1: EditPageForm.tsx - Logger Import
- [ ] Task 2: ã‚µãƒ ãƒã‚¤ãƒ«è‡ªå‹•è¨­å®šã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
- [ ] Task 3: ãƒšãƒ¼ã‚¸å‰Šé™¤ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
- [ ] Task 4: page-links-grid.tsx - Logger Import
- [ ] Task 5: ãƒšãƒ¼ã‚¸ä½œæˆå¤±æ•—ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°
- [ ] Lint ãƒã‚§ãƒƒã‚¯
- [ ] ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
- [ ] ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèª

#### å®Œäº†æ™‚åˆ»: __:__

#### æ‰€è¦æ™‚é–“: __ åˆ†

#### æ°—ã¥ããƒ»ãƒ¡ãƒ¢
```
ï¼ˆä½œæ¥­ä¸­ã®æ°—ã¥ãã‚„å•é¡Œç‚¹ã‚’è¨˜éŒ²ï¼‰
```

---

## ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **å®Ÿè£…è¨ˆç”»**: `docs/03_plans/pr31-review-fixes/20251029_01_implementation-plan.md`
- **PR#31**: https://github.com/otomatty/for-all-learners/pull/31
- **Loggerå®Ÿè£…**: `lib/logger.ts`

---

**æœ€çµ‚æ›´æ–°**: 2025-10-29  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æº–å‚™å®Œäº† âœ…
