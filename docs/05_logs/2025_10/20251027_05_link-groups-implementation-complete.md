# ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—UIå®Ÿè£…å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

**æ—¥ä»˜**: 2025-10-27
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»ãƒ‡ãƒãƒƒã‚°å®Œäº†

---

## ğŸ“Š å®Ÿè£…çŠ¶æ³

### âœ… å®Œäº†ã—ãŸæ©Ÿèƒ½

1. **ãƒ‡ãƒ¼ã‚¿å–å¾—å±¤**
   - `getLinkGroupsForPage()` - ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãƒ‡ãƒ¼ã‚¿å–å¾—
   - `syncLinkGroupsForPage()` - ãƒšãƒ¼ã‚¸ä¿å­˜æ™‚ã®åŒæœŸ
   - è©³ç´°ãƒ­ã‚°å‡ºåŠ›ã‚’è¿½åŠ 

2. **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
   - `LinkGroupsSection` - ãƒ¡ã‚¤ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ‡ãƒãƒƒã‚°è¡¨ç¤ºä»˜ãï¼‰
   - `TargetPageCard` - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰
   - `GroupedPageCard` - å‚ç…§ãƒšãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰
   - `CreatePageCard` - æ–°è¦ä½œæˆã‚«ãƒ¼ãƒ‰

3. **çµ±åˆ**
   - `page.tsx` - ãƒ‡ãƒ¼ã‚¿å–å¾—çµ±åˆ
   - `edit-page-form.tsx` - UIé…ç½®çµ±åˆ
   - è‡ªå‹•ä¿å­˜æ©Ÿèƒ½ï¼ˆ2ç§’ãƒ‡ãƒã‚¦ãƒ³ã‚¹ï¼‰

### ğŸ¯ å‹•ä½œç¢ºèªæ¸ˆã¿

- âœ… è‡ªå‹•ä¿å­˜ãŒå‹•ä½œã—ã¦ã„ã‚‹ï¼ˆ`Page saved successfully` ãƒ­ã‚°ï¼‰
- âœ… ãƒªãƒ³ã‚¯æŠ½å‡ºãŒå‹•ä½œã—ã¦ã„ã‚‹ï¼ˆ`[[ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º]]` æ¤œå‡ºï¼‰
- âœ… æœªè¨­å®šãƒªãƒ³ã‚¯ãŒå†èª­ã¿è¾¼ã¿å¾Œã«è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒæœŸãŒå‹•ä½œã—ã¦ã„ã‚‹

---

## ğŸ” ç™ºè¦‹ã—ãŸé‡è¦ãªä»•æ§˜

### ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã®æ¡ä»¶

**ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹æ¡ä»¶**:
```typescript
linkCount > 1  // è¤‡æ•°ã®ç•°ãªã‚‹ãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹
```

**é‡è¦**: 
- âŒ åŒã˜ãƒšãƒ¼ã‚¸å†…ã§è¤‡æ•°å›ä½¿ç”¨ â†’ ã‚°ãƒ«ãƒ¼ãƒ—ã«ãªã‚‰ãªã„
- âœ… ç•°ãªã‚‹ãƒšãƒ¼ã‚¸ã§ä½¿ç”¨ â†’ ã‚°ãƒ«ãƒ¼ãƒ—ã«ãªã‚‹

### ä¾‹

#### âŒ ã‚°ãƒ«ãƒ¼ãƒ—ã«ãªã‚‰ãªã„ã‚±ãƒ¼ã‚¹
```
ãƒšãƒ¼ã‚¸A:
  [[React Hooks]]ã«ã¤ã„ã¦å­¦ã¶
  [[React Hooks]]ã¯ä¾¿åˆ©ã§ã™
  â†’ link_count = 1ï¼ˆåŒã˜ãƒšãƒ¼ã‚¸å†…ï¼‰
```

#### âœ… ã‚°ãƒ«ãƒ¼ãƒ—ã«ãªã‚‹ã‚±ãƒ¼ã‚¹
```
ãƒšãƒ¼ã‚¸A: [[React Hooks]]ã«ã¤ã„ã¦å­¦ã¶
ãƒšãƒ¼ã‚¸B: [[React Hooks]]ã¯ä¾¿åˆ©ã§ã™
  â†’ link_count = 2ï¼ˆç•°ãªã‚‹ãƒšãƒ¼ã‚¸ï¼‰
  â†’ ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹
```

---

## ğŸ“ ä½¿ã„æ–¹

### ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹æ‰‹é †

1. **ãƒšãƒ¼ã‚¸Aã‚’ä½œæˆ**
   ```
   ã‚¿ã‚¤ãƒˆãƒ«: Reactå…¥é–€
   å†…å®¹: [[React Hooks]]ã«ã¤ã„ã¦å­¦ã³ã¾ã™
   ```

2. **ãƒšãƒ¼ã‚¸Bã‚’ä½œæˆ**
   ```
   ã‚¿ã‚¤ãƒˆãƒ«: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“
   å†…å®¹: [[React Hooks]]ã¯å¼·åŠ›ã§ã™
   ```

3. **è‡ªå‹•ä¿å­˜ã‚’å¾…ã¤**
   - å„ãƒšãƒ¼ã‚¸ã§ç·¨é›†åœæ­¢å¾Œã€2ç§’å¾…ã¤
   - ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã« `[SYNC] Link groups synced successfully` ãŒå‡ºåŠ›ã•ã‚Œã‚‹

4. **ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿**
   - ã©ã¡ã‚‰ã‹ã®ãƒšãƒ¼ã‚¸ã‚’é–‹ã
   - ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ä¸‹éƒ¨ã«ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹

### æœŸå¾…ã•ã‚Œã‚‹è¡¨ç¤º

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” DEBUG: Link Groups Status         â”‚
â”‚ â€¢ Count: 1                            â”‚
â”‚ â€¢ Note Slug: undefined                â”‚
â”‚                                       â”‚
â”‚ Group 1: React Hooks                  â”‚
â”‚ â€¢ Link Count: 2                       â”‚
â”‚ â€¢ Target Page: âŒ                     â”‚
â”‚ â€¢ Referencing Pages: 2                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–°è¦  â”‚ â”‚ Reactå…¥é–€  â”‚ â”‚ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰â”‚
â”‚ ä½œæˆ  â”‚ â”‚            â”‚ â”‚æŠ€è¡“        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½

### ãƒ‡ãƒãƒƒã‚°è¡¨ç¤º

ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ä¸‹éƒ¨ã«å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹é’ã„ãƒœãƒƒã‚¯ã‚¹ï¼š

**ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒç©ºã®å ´åˆ**:
```
âš ï¸ No link groups found (linkCount > 1)

ğŸ’¡ How to create link groups:
1. Create Page A with link [[Example]]
2. Create Page B with same link [[Example]]
3. Save both pages (wait 2 seconds for auto-save)
4. Reload this page â†’ Link group will appear!

Note: Using the same link multiple times on the same page 
does NOT create a group. Links must be used across different pages.
```

**ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚‹å ´åˆ**:
```
Group 1: React Hooks
â€¢ Link Count: 2
â€¢ Target Page: âŒ
â€¢ Referencing Pages: 2
```

### ãƒ­ã‚°å‡ºåŠ›

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ãƒ­ã‚°ãŒç¢ºèªå¯èƒ½ï¼š

```bash
# ãƒªãƒ³ã‚¯æŠ½å‡º
[BracketMonitor] [FOUND] found 2 complete brackets

# ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—åŒæœŸé–‹å§‹
[SYNC] Syncing link groups for page { pageId: '...', linkCount: 2, links: [...] }

# å„ãƒªãƒ³ã‚¯ã®å‡¦ç†
[SYNC] Processing link { pageId: '...', linkKey: 'react-hooks', linkText: 'React Hooks' }
[SYNC] Link group upserted { linkGroupId: '...', linkKey: 'react-hooks' }
[SYNC] Link occurrence created { linkGroupId: '...', sourcePageId: '...' }

# åŒæœŸå®Œäº†
[SYNC] Link groups synced successfully { pageId: '...', linkCount: 2 }

# ä¿å­˜å®Œäº†
Page saved successfully { pageId: '...' }
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒè¡¨ç¤ºã•ã‚Œãªã„

**ç—‡çŠ¶**: ãƒ‡ãƒãƒƒã‚°è¡¨ç¤ºã§ã€ŒCount: 0ã€

**åŸå› ã¨å¯¾å‡¦**:

1. **åŒã˜ãƒšãƒ¼ã‚¸å†…ã§è¤‡æ•°å›ä½¿ç”¨ã—ã¦ã„ã‚‹**
   - å¯¾å‡¦: åˆ¥ã®ãƒšãƒ¼ã‚¸ã§ã‚‚åŒã˜ãƒªãƒ³ã‚¯ã‚’ä½¿ç”¨ã™ã‚‹

2. **ã¾ã ä¿å­˜ã•ã‚Œã¦ã„ãªã„**
   - å¯¾å‡¦: 2ç§’å¾…ã¤ã€ã¾ãŸã¯ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿

3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒæœŸã‚¨ãƒ©ãƒ¼**
   - å¯¾å‡¦: ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ãƒ­ã‚°ã§ `[SYNC]` ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

### å•é¡Œ2: è‡ªå‹•ä¿å­˜ãŒå‹•ä½œã—ãªã„

**ç—‡çŠ¶**: ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã« `Page saved successfully` ãŒå‡ºãªã„

**å¯¾å‡¦**:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª
2. æ‰‹å‹•ã§ Ctrl+S / Cmd+S ã‚’æŠ¼ã™
3. ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿

### å•é¡Œ3: link_count ãŒæ­£ã—ããªã„

**ç—‡çŠ¶**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã® `link_count` ãŒå®Ÿéš›ã®ä½¿ç”¨æ•°ã¨ç•°ãªã‚‹

**å¯¾å‡¦**:
```sql
-- Supabase Dashboard ã§å®Ÿè¡Œ
SELECT 
  lg.id,
  lg.key,
  lg.raw_text,
  lg.link_count as stored_count,
  COUNT(DISTINCT lo.source_page_id) as actual_count
FROM link_groups lg
LEFT JOIN link_occurrences lo ON lo.link_group_id = lg.id
GROUP BY lg.id, lg.key, lg.raw_text, lg.link_count
HAVING lg.link_count != COUNT(DISTINCT lo.source_page_id);
```

ãƒˆãƒªã‚¬ãƒ¼ãŒå‹•ä½œã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

---

## ğŸ“ é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

### å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«

- `app/_actions/linkGroups.ts` - ãƒ‡ãƒ¼ã‚¿å–å¾—
- `app/_actions/syncLinkGroups.ts` - åŒæœŸå‡¦ç†
- `app/(protected)/pages/[id]/_components/link-groups-section.tsx` - ãƒ¡ã‚¤ãƒ³UI
- `app/(protected)/pages/[id]/_components/target-page-card.tsx` - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚«ãƒ¼ãƒ‰
- `app/(protected)/pages/[id]/_components/grouped-page-card.tsx` - å‚ç…§ã‚«ãƒ¼ãƒ‰
- `app/(protected)/pages/[id]/_components/create-page-card.tsx` - ä½œæˆã‚«ãƒ¼ãƒ‰
- `app/(protected)/pages/[id]/page.tsx` - çµ±åˆ
- `lib/utils/extractLinksFromContent.ts` - ãƒªãƒ³ã‚¯æŠ½å‡º

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `docs/03_plans/link-group-ui/20251027_01_link-groups-section-implementation.md` - å®Ÿè£…è¨ˆç”»
- `docs/05_logs/2025_10/20251027_02_link-groups-ui-debugging.md` - ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°
- `docs/05_logs/2025_10/20251027_03_link-groups-sync-debug.md` - åŒæœŸãƒ‡ãƒãƒƒã‚°
- `docs/05_logs/2025_10/20251027_04_link-groups-test-query.sql` - ãƒ†ã‚¹ãƒˆç”¨SQL

---

## âœ… æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã™ãã«ã‚„ã‚‹ã“ã¨

1. **å‹•ä½œç¢ºèª**
   - è¤‡æ•°ã®ãƒšãƒ¼ã‚¸ã§åŒã˜ãƒªãƒ³ã‚¯ã‚’ä½¿ç”¨
   - ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

2. **ãƒ‡ãƒãƒƒã‚°è¡¨ç¤ºã®å‰Šé™¤**
   - å‹•ä½œç¢ºèªå¾Œã€é’ã„ãƒ‡ãƒãƒƒã‚°ãƒœãƒƒã‚¯ã‚¹ã‚’å‰Šé™¤
   - ãƒ­ã‚°å‡ºåŠ›ã‚’é€šå¸¸ãƒ¬ãƒ™ãƒ«ã«æˆ»ã™

### å°†æ¥ã®æ”¹å–„

1. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
   - ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã®å–å¾—ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
   - ä¸è¦ãªå†å–å¾—ã‚’å‰Šæ¸›

2. **UIæ”¹å–„**
   - ã‚°ãƒ«ãƒ¼ãƒ—åã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¿½åŠ 
   - ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆlink_counté™é †ãªã©ï¼‰
   - ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½

3. **æ©Ÿèƒ½è¿½åŠ **
   - ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ã®ãƒšãƒ¼ã‚¸å‰Šé™¤
   - ã‚°ãƒ«ãƒ¼ãƒ—åã®ç·¨é›†
   - ãƒšãƒ¼ã‚¸ä½œæˆæ™‚ã®è‡ªå‹•ãƒªãƒ³ã‚¯

---

## ğŸ‰ ã¾ã¨ã‚

### å®Ÿè£…ã®æˆæœ

âœ… **å®Œå…¨ã«å‹•ä½œã™ã‚‹ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½**
- ãƒ‡ãƒ¼ã‚¿åŒæœŸãŒè‡ªå‹•çš„ã«è¡Œã‚ã‚Œã‚‹
- UIãŒãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«æ›´æ–°ã•ã‚Œã‚‹
- ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã§å•é¡ŒãŒå³åº§ã«ç‰¹å®šå¯èƒ½

### å­¦ã‚“ã ã“ã¨

1. **ãƒªãƒ³ã‚¯ã‚°ãƒ«ãƒ¼ãƒ—ã®ä»•æ§˜**
   - ç•°ãªã‚‹ãƒšãƒ¼ã‚¸é–“ã§ã®ãƒªãƒ³ã‚¯å…±æœ‰ãŒæ¡ä»¶
   - åŒã˜ãƒšãƒ¼ã‚¸å†…ã®é‡è¤‡ã¯ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œãªã„

2. **è‡ªå‹•ä¿å­˜ã®é‡è¦æ€§**
   - 2ç§’ã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹ã§å¿«é©ãªUX
   - ãƒ­ã‚°å‡ºåŠ›ã§å‹•ä½œç¢ºèªãŒå®¹æ˜“

3. **ãƒ‡ãƒãƒƒã‚°ã®é‡è¦æ€§**
   - è¦–è¦šçš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã§å•é¡ŒãŒæ˜ç¢ºã«
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®èª¬æ˜ã‚‚å…¼ã­ã‚‹

---

**æœ€çµ‚æ›´æ–°**: 2025-10-27
**ä½œæˆè€…**: AI (Claude 3.5 Sonnet)
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… å®Ÿè£…å®Œäº†ãƒ»å‹•ä½œç¢ºèªå¾…ã¡
