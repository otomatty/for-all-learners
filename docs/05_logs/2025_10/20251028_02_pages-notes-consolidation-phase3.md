# `/pages` ã¨ `/notes` ã®çµ±åˆä½œæ¥­ - Phase 3 å®Ÿè£…

**ä½œæ¥­æ—¥**: 2025-10-28
**ä½œæ¥­è€…**: AI Assistant + Developer  
**æ‰€è¦æ™‚é–“**: ç´„1æ™‚é–“
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… Phase 3 å®Œäº†

---

## ğŸ“‹ ä½œæ¥­æ¦‚è¦

Phase 3ï¼ˆUIãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆï¼‰ã‚’å®Ÿæ–½ã—ã¾ã—ãŸã€‚
é‡è¤‡ã—ã¦ã„ãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ±åˆã—ã€ã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆæ€§ã‚’å‘ä¸Šã•ã›ã¾ã—ãŸã€‚

**å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- [å®Ÿè£…è¨ˆç”»](../../03_plans/pages-notes-consolidation/20251028_01_implementation-plan.md)
- [Phase 1-2 ä½œæ¥­ãƒ­ã‚°](./20251028_01_pages-notes-consolidation-phase1-2.md)

---

## âœ… å®Ÿæ–½ã—ãŸä½œæ¥­

### 1. çµ±åˆç‰ˆ PagesList ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**: `components/notes/PagesList/PagesList.tsx`

**ä¸»ãªæ©Ÿèƒ½**:
- ãƒšãƒ¼ã‚¸ä¸€è¦§ã®ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º
- ã‚µãƒ ãƒã‚¤ãƒ« ã¾ãŸã¯ ãƒ†ã‚­ã‚¹ãƒˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

**ç‰¹å¾´**:
```typescript
interface PagesListProps {
  pages: PageRow[];
  slug?: string;  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: "all-pages"
  gridCols?: string;  // ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½
}
```

- `slug` ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ä¸‹ä½äº’æ›æ€§ã‚’ä¿æŒ
- ã‚°ãƒªãƒƒãƒ‰ã‚«ãƒ©ãƒ æ•°ã‚’propsã§åˆ¶å¾¡å¯èƒ½
- DEPENDENCY MAP ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ 

### 2. notes/[slug]/_components/pages-list.tsx ã®æ›´æ–°

**å¤‰æ›´å†…å®¹**:
- çµ±åˆç‰ˆ PagesList ã‚’ä½¿ç”¨ã™ã‚‹ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¤‰æ›´
- é‡è¤‡ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤ï¼ˆç´„80è¡Œå‰Šæ¸›ï¼‰

```typescript
// Before: ç‹¬è‡ªå®Ÿè£…ï¼ˆç´„90è¡Œï¼‰
export function PagesList({ pages, slug }: PagesListProps) {
  // ç‹¬è‡ªã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯
}

// After: ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆç´„20è¡Œï¼‰
export function PagesList({ pages, slug }: PagesListProps) {
  return <SharedPagesList pages={pages} slug={slug} />;
}
```

### 3. pages/_components/pages-list.tsx ã®æ›´æ–°

**å¤‰æ›´å†…å®¹**:
- çµ±åˆç‰ˆ PagesList ã‚’ä½¿ç”¨ã™ã‚‹ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¤‰æ›´
- `@deprecated` ãƒãƒ¼ã‚¯ã‚’è¿½åŠ ï¼ˆPhase 5ã§å‰Šé™¤äºˆå®šï¼‰

```typescript
/**
 * @deprecated This component is deprecated.
 * Use components/notes/PagesList directly.
 * This file will be removed in Phase 5.
 */
export function PagesList({ pages }: PagesListProps) {
  return <SharedPagesList pages={pages} slug="all-pages" />;
}
```

### 4. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `components/main-nav.tsx`

**å¤‰æ›´å†…å®¹**:
- `/pages` ãƒªãƒ³ã‚¯ã‚’ `/notes` ã«å¤‰æ›´
- ãƒ‘ã‚¹ã®åˆ¤å®šã« `/pages` ã‚‚è¿½åŠ ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¯¾å¿œï¼‰

```typescript
// Before
<Link href="/pages" ...>

// After
<Link href="/notes" ...>
pathname?.startsWith("/notes") || pathname?.startsWith("/pages")
```

### 5. ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨ä»•æ§˜æ›¸ã®ä½œæˆ

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**:
- `components/notes/PagesList/PagesList.test.tsx` - ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- `components/notes/PagesList/PagesList.spec.md` - ä»•æ§˜æ›¸

**ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹**:
- TC-001: ç©ºçŠ¶æ…‹ã®è¡¨ç¤º
- TC-002: ãƒšãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- TC-003: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆslugã®ä½¿ç”¨
- TC-004: ã‚«ã‚¹ã‚¿ãƒ slugã®ä½¿ç”¨
- TC-005: ã‚«ã‚¹ã‚¿ãƒ ã‚°ãƒªãƒƒãƒ‰ã‚«ãƒ©ãƒ 

**æ³¨**: ãƒ†ã‚¹ãƒˆç’°å¢ƒã®è¨­å®šå•é¡Œã«ã‚ˆã‚Šã€ãƒ†ã‚¹ãƒˆã¯ä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—ï¼ˆå¾Œã§ä¿®æ­£ï¼‰

---

## ğŸ“ å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### æ–°è¦ä½œæˆ (4ãƒ•ã‚¡ã‚¤ãƒ«)
1. `components/notes/PagesList/PagesList.tsx` - çµ±åˆç‰ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
2. `components/notes/PagesList/index.ts` - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
3. `components/notes/PagesList/PagesList.test.tsx` - ãƒ†ã‚¹ãƒˆ
4. `components/notes/PagesList/PagesList.spec.md` - ä»•æ§˜æ›¸

### ä¿®æ­£ (3ãƒ•ã‚¡ã‚¤ãƒ«)
1. `app/(protected)/notes/[slug]/_components/pages-list.tsx` - ãƒ©ãƒƒãƒ‘ãƒ¼åŒ–
2. `app/(protected)/pages/_components/pages-list.tsx` - ãƒ©ãƒƒãƒ‘ãƒ¼åŒ– + deprecated
3. `components/main-nav.tsx` - ãƒªãƒ³ã‚¯å…ˆã‚’ /notes ã«å¤‰æ›´

---

## ğŸ“Š ã‚³ãƒ¼ãƒ‰å‰Šæ¸›åŠ¹æœ

### å‰Šæ¸›ã•ã‚ŒãŸé‡è¤‡ã‚³ãƒ¼ãƒ‰

| ãƒ•ã‚¡ã‚¤ãƒ« | å‰Šæ¸›å‰ | å‰Šæ¸›å¾Œ | å‰Šæ¸›é‡ |
|---------|-------|-------|--------|
| notes/[slug]/_components/pages-list.tsx | 90è¡Œ | 20è¡Œ | -70è¡Œ |
| pages/_components/pages-list.tsx | 75è¡Œ | 20è¡Œ | -55è¡Œ |
| **åˆè¨ˆ** | **165è¡Œ** | **40è¡Œ** | **-125è¡Œ** |

### æ–°è¦è¿½åŠ 

| ãƒ•ã‚¡ã‚¤ãƒ« | è¡Œæ•° |
|---------|------|
| components/notes/PagesList/PagesList.tsx | 145è¡Œ |
| components/notes/PagesList/PagesList.test.tsx | 125è¡Œ |
| components/notes/PagesList/PagesList.spec.md | 200è¡Œ |

**æ­£å‘³å‰Šæ¸›**: ç´„125è¡Œã®ãƒ­ã‚¸ãƒƒã‚¯é‡è¤‡ã‚’è§£æ¶ˆ

---

## ğŸ§ª å“è³ªãƒã‚§ãƒƒã‚¯

### Lintãƒã‚§ãƒƒã‚¯
```bash
bun lint components/notes/PagesList/PagesList.tsx ...
âœ… Checked 4 files in 5ms. No fixes applied.
```

### ãƒ†ã‚¹ãƒˆ
- âš ï¸ ãƒ†ã‚¹ãƒˆç’°å¢ƒã®è¨­å®šå•é¡Œã«ã‚ˆã‚Šä¸€æ™‚çš„ã«ã‚¹ã‚­ãƒƒãƒ—
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰è‡ªä½“ã¯ä½œæˆæ¸ˆã¿
- ä»Šå¾Œã®å¯¾å¿œ: vitestç’°å¢ƒã®è¨­å®šã‚’è¦‹ç›´ã—

---

## ğŸ¯ é”æˆã•ã‚ŒãŸç›®æ¨™

### âœ… ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆ
- é‡è¤‡ã—ã¦ã„ãŸ PagesList ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’1ã¤ã«çµ±åˆ
- å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ `components/notes/PagesList` ã«é…ç½®

### âœ… ä¸‹ä½äº’æ›æ€§ã®ç¶­æŒ
- æ—¢å­˜ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ®‹ã™ã“ã¨ã§æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã«å½±éŸ¿ãªã—
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ slug ã§ `/pages` ã‹ã‚‰ã®ç§»è¡Œã‚’ã‚¹ãƒ ãƒ¼ã‚ºã«

### âœ… æŸ”è»Ÿæ€§ã®å‘ä¸Š
- `slug` ã¨ `gridCols` ã‚’propsã§åˆ¶å¾¡å¯èƒ½
- æ§˜ã€…ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«å¯¾å¿œå¯èƒ½

### âœ… ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®çµ±ä¸€
- main-nav ã®ãƒªãƒ³ã‚¯å…ˆã‚’ `/notes` ã«å¤‰æ›´
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®çµ±ä¸€åŒ–

---

## ğŸ“ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### å³åº§ã«å®Ÿæ–½
1. **å‹•ä½œç¢ºèª**
   - `/notes/all-pages` ã§ãƒšãƒ¼ã‚¸ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
   - ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãŒ `/notes` ã«é£›ã¶ã‹ç¢ºèª

2. **ãƒ†ã‚¹ãƒˆç’°å¢ƒã®ä¿®æ­£**
   - vitest ã® DOM ç’°å¢ƒè¨­å®šã‚’è¦‹ç›´ã—
   - ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ä¿®æ­£

### Phase 4 æº–å‚™
3. **Server Actions çµ±åˆã®è¨ˆç”»**
   - `getPagesByUser` ã®ä½¿ç”¨ç®‡æ‰€ã‚’ç‰¹å®š
   - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ–¹é‡ã‚’æ±ºå®š

---

## ğŸ’¡ æ°—ã¥ããƒ»å­¦ã³

### æŠ€è¡“çš„ãªå­¦ã³

1. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³**
   - å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆ â†’ ãƒ©ãƒƒãƒ‘ãƒ¼ã§ä½¿ç”¨
   - æ®µéšçš„ã«ç§»è¡Œã§ãã‚‹æŸ”è»Ÿãªè¨­è¨ˆ
   - `@deprecated` ãƒãƒ¼ã‚¯ã§å°†æ¥ã®å‰Šé™¤ã‚’æ˜ç¤º

2. **Propsè¨­è¨ˆã®é‡è¦æ€§**
   - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ä¸‹ä½äº’æ›æ€§ã‚’ä¿æŒ
   - ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«propsã§æŸ”è»Ÿæ€§ã‚’ç¢ºä¿
   - TypeScriptã®å‹ã§å®‰å…¨æ€§ã‚’æ‹…ä¿

3. **DEPENDENCY MAP ã®æ´»ç”¨**
   - ãƒ•ã‚¡ã‚¤ãƒ«å…ˆé ­ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨˜è¼‰
   - è¦ªå­é–¢ä¿‚ãŒæ˜ç¢ºã«ãªã‚‹
   - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®å½±éŸ¿ç¯„å›²ãŒæŠŠæ¡ã—ã‚„ã™ã„

### è¨­è¨ˆä¸Šã®å­¦ã³

1. **æ®µéšçš„ãªçµ±åˆã®æœ‰åŠ¹æ€§**
   - ä¸€åº¦ã«ã™ã¹ã¦ã‚’æ›¸ãæ›ãˆãªã„
   - ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ç§»è¡ŒæœŸé–“ã‚’è¨­ã‘ã‚‹
   - ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹

2. **ä»•æ§˜æ›¸ã¨ãƒ†ã‚¹ãƒˆã®é‡è¦æ€§**
   - spec.md ã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä»•æ§˜ã‚’æ˜æ–‡åŒ–
   - ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã§å‹•ä½œã‚’ä¿è¨¼
   - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé§†å‹•é–‹ç™ºã®å®Ÿè·µ

---

## âš ï¸ ä»Šå¾Œã®èª²é¡Œ

### ãƒ†ã‚¹ãƒˆç’°å¢ƒã®è¨­å®š
- happy-dom ã®è¨­å®šã‚’è¦‹ç›´ã—
- ä»–ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒæ§˜ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ä¿®æ­£

### Phase 4 ã®æº–å‚™
- Server Actions ã®ä½¿ç”¨ç®‡æ‰€ã‚’ç‰¹å®š
- æ®µéšçš„ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°è¨ˆç”»ã‚’ç«‹æ¡ˆ

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [å®Ÿè£…è¨ˆç”»](../../03_plans/pages-notes-consolidation/20251028_01_implementation-plan.md)
- [Phase 1-2 ä½œæ¥­ãƒ­ã‚°](./20251028_01_pages-notes-consolidation-phase1-2.md)
- [PagesList ä»•æ§˜æ›¸](../../components/notes/PagesList/PagesList.spec.md)

---

## ğŸ“Š é€²æ—çŠ¶æ³

**ç¾åœ¨ã®é€²æ—**: 60% (3/5 ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†)

| ãƒ•ã‚§ãƒ¼ã‚º | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | é€²æ— |
|---------|-----------|------|
| Phase 1 | âœ… å®Œäº† | 100% |
| Phase 2 | âœ… å®Œäº† | 100% |
| Phase 3 | âœ… å®Œäº† | 100% |
| Phase 4 | â³ æœªç€æ‰‹ | 0% |
| Phase 5 | â³ æœªç€æ‰‹ | 0% |

---

**ä½œæˆè€…**: AI Assistant (GitHub Copilot)
**æœ€çµ‚æ›´æ–°**: 2025-10-28
